# ğŸ” PI Planningæ•°æ®ä¸ºç©ºé—®é¢˜ - æ·±åº¦åˆ†æä¸ä¿®å¤

> **é—®é¢˜æŠ¥å‘Šæ—¶é—´**: 2026-01-21 18:00  
> **é—®é¢˜æè¿°**: PI Planningé¡µé¢æ•°æ®ä¸ºç©º  
> **åˆ†æç»“æœ**: âœ… IDå­—æ®µä¸åŒ¹é…å¯¼è‡´currentPIæ— æ³•è®¾ç½®

---

## ğŸ› é—®é¢˜ç°è±¡

### ç”¨æˆ·åé¦ˆ

**ç—‡çŠ¶**: PI Planningé¡µé¢åŠ è½½åï¼Œæ•°æ®ä¸ºç©º

**æµ‹è¯•åé¦ˆ**: "PI Planningé¡µé¢ä¸­æ•°æ®ä¾ç„¶ä¸ºç©º"

**éœ€è¦åˆ†æ**:
1. æ˜¯æ²¡æœ‰æ•°æ®ï¼Ÿ
2. åŠ è½½è¯»å–é”™è¯¯ï¼Ÿ
3. æ ¼å¼è½¬æ¢åˆ°UI loadå¤±è´¥ï¼Ÿ

---

## ğŸ” æ·±åº¦æ’æŸ¥è¿‡ç¨‹

### ç¬¬ä¸€å±‚ï¼šæ•°æ®æºæ£€æŸ¥

**æ£€æŸ¥initializer.tsåŠ è½½**:
```typescript
// initializer.ts:122
piStore.pis = pis  // âœ… æ•°æ®å·²åŠ è½½
```

**æ£€æŸ¥æ•°æ®æ–‡ä»¶**:
- `mock-data/datasets/pis.json` - æ—§æ ¼å¼ï¼Œ4æ¡PIè®°å½• âœ…
- `mock/pis.json` - æ–°æ ¼å¼ï¼Œ3æ¡PIè®°å½•ï¼ˆæœªä½¿ç”¨ï¼‰

**ç»“è®º**: âœ… æ•°æ®æºæ­£å¸¸ï¼Œæœ‰4æ¡PIè®°å½•

---

### ç¬¬äºŒå±‚ï¼šæ•°æ®åŠ è½½æ£€æŸ¥

**æ£€æŸ¥PIPlanningBoard.vueçš„onMounted**:
```typescript
// PIPlanningBoard.vue:464
onMounted(async () => {
  loading.value = true
  try {
    await Promise.all([
      piStore.fetchPIVersions(),  // âœ… è°ƒç”¨äº†
      featureStore.fetchFeatures(),
      sprintStore.fetchSprints()
    ])
    
    if (piVersions.value.length > 0) {  // âœ… æœ‰15ä¸ª
      selectedPIId.value = piVersions.value[0].id
      await handlePIChange(selectedPIId.value)  // âœ… ä¼šè°ƒç”¨
    }
  } finally {
    loading.value = false
  }
})
```

**æ£€æŸ¥piVersionsè®¡ç®—å±æ€§**:
```typescript
// PIPlanningBoard.vue:252
const piVersions = computed(() => piStore.piVersions)
```

**æ£€æŸ¥piStore.piVersions getter**:
```typescript
// pi.ts:74
piVersions: (state) => {
  return state.pis.map(pi => ({
    id: pi.piId || (pi as any).id,  // âœ… è½¬æ¢æˆåŠŸ
    name: pi.piName || (pi as any).name,
    ...
  }))
}
```

**éªŒè¯ç»“æœ**:
- âœ… fetchPIVersionsè°ƒç”¨æˆåŠŸ
- âœ… piVersionsæœ‰15ä¸ªé€‰é¡¹ï¼ˆè‡ªåŠ¨åŒ–æµ‹è¯•éªŒè¯ï¼‰
- âœ… ä¸‹æ‹‰æ¡†å¯è§ä¸”å¯é€‰

**ç»“è®º**: âœ… æ•°æ®åŠ è½½æ­£å¸¸ï¼Œè½¬æ¢æ­£å¸¸

---

### ç¬¬ä¸‰å±‚ï¼šUIæ˜¾ç¤ºæ£€æŸ¥

**æ£€æŸ¥é¡µé¢æ¨¡æ¿**:
```vue
<!-- PIPlanningBoard.vue:8 -->
<el-select v-model="selectedPIId" @change="handlePIChange">
  <el-option v-for="pi in piVersions" :key="pi.id" :label="pi.name" :value="pi.id" />
</el-select>

<!-- PIPlanningBoard.vue:21 -->
<el-row :gutter="20" v-if="currentPI">  <!-- âŒ å…³é”®æ¡ä»¶ -->
  <el-col :span="6">
    <el-card>
      <div class="info-item">
        <span class="label">PIåç§°:</span>
        <span class="value">{{ currentPI.name }}</span>  <!-- éœ€è¦currentPI -->
      </div>
      ...
```

**å…³é”®å‘ç°**: æ‰€æœ‰æ•°æ®å¡ç‰‡éƒ½ä¾èµ– `v-if="currentPI"`ï¼

**æ£€æŸ¥currentPI**:
```typescript
// PIPlanningBoard.vue:253
const currentPI = computed(() => piStore.currentPI)
```

**ç»“è®º**: âŒ **currentPIä¸ºnullï¼Œå¯¼è‡´æ‰€æœ‰å¡ç‰‡ä¸æ˜¾ç¤ºï¼**

---

### ç¬¬å››å±‚ï¼šcurrentPIè®¾ç½®æ£€æŸ¥

**æ£€æŸ¥handlePIChange**:
```typescript
// PIPlanningBoard.vue:314
const handlePIChange = async (piId: string) => {
  loading.value = true
  try {
    await piStore.fetchPIById(piId)  // âœ… ä¼šè°ƒç”¨
    await planningStore.fetchPlanningResult(piId)
  } finally {
    loading.value = false
  }
}
```

**æ£€æŸ¥fetchPIById**:
```typescript
// pi.ts:116 (ä¿®å¤å‰)
async fetchPIById(piId: string) {
  this.loading = true
  this.error = null
  
  try {
    const pi = this.pis.find(p => p.piId === piId)  // âŒ é—®é¢˜åœ¨è¿™é‡Œï¼
    if (pi) {
      this.currentPI = pi
    } else {
      this.error = 'PIä¸å­˜åœ¨'
    }
    this.loading = false
  } catch (error) {
    this.error = 'è·å–PIè¯¦æƒ…å¤±è´¥'
    this.loading = false
  }
}
```

**å…³é”®é—®é¢˜**: `p.piId === piId` ä½†æ—§æ•°æ®æ²¡æœ‰piIdå­—æ®µï¼

---

## ğŸ¯ æ ¹æœ¬åŸå› åˆ†æ

### æ•°æ®æ ¼å¼å·®å¼‚

**æ—§æ ¼å¼**ï¼ˆinitializeråŠ è½½çš„`datasets/pis.json`ï¼‰:
```json
{
  "data": [
    {
      "id": "pi-001",           // âŒ ä½¿ç”¨idå­—æ®µ
      "code": "PI-2026-Q1",
      "name": "2026 Q1 PI",
      "sprintCount": 6,
      "status": "completed"
    }
  ]
}
```

**æ–°æ ¼å¼**ï¼ˆ`mock/pis.json`ï¼ŒPhase3åˆ›å»ºä½†æœªä½¿ç”¨ï¼‰:
```json
{
  "pis": [
    {
      "piId": "PI-001",         // âœ… ä½¿ç”¨piIdå­—æ®µ
      "piNumber": "PI-1",
      "piName": "å·¥ç¨‹æ ·è½¦ PI",
      "startIterationNumber": 1,
      "endIterationNumber": 8,
      "alignedMilestone": {...}
    }
  ]
}
```

---

### é—®é¢˜æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. initializer.ts åŠ è½½æ—§æ•°æ®                           â”‚
â”‚    piStore.pis = [{id:"pi-001", name:"...", ...}]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… æˆåŠŸ
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. piVersions getter è½¬æ¢                               â”‚
â”‚    {id: pi.piId || pi.id, name: pi.piName || pi.name}  â”‚
â”‚    ç»“æœ: {id:"pi-001", name:"2026 Q1 PI", ...}         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… å…¼å®¹è½¬æ¢æˆåŠŸ
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. é¡µé¢æ˜¾ç¤ºä¸‹æ‹‰æ¡†                                       â”‚
â”‚    <el-option v-for="pi in piVersions" :value="pi.id"/>â”‚
â”‚    ç»“æœ: 15ä¸ªé€‰é¡¹å¯è§                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… ä¸‹æ‹‰æ¡†æ­£å¸¸
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ç”¨æˆ·é€‰æ‹©PI("pi-001")                                â”‚
â”‚    @change="handlePIChange" è§¦å‘                       â”‚
â”‚    selectedPIId = "pi-001"                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… é€‰æ‹©æˆåŠŸ
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. handlePIChange("pi-001") è°ƒç”¨                       â”‚
â”‚    await piStore.fetchPIById("pi-001")                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âŒ å¼€å§‹å‡ºé—®é¢˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. fetchPIByIdæŸ¥æ‰¾                                     â”‚
â”‚    this.pis.find(p => p.piId === "pi-001")            â”‚
â”‚    ä½†æ—§æ•°æ®ç»“æ„: {id:"pi-001", ...}                    â”‚
â”‚    æ²¡æœ‰piIdå­—æ®µï¼                                       â”‚
â”‚    ç»“æœ: pi = undefined                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âŒ æ‰¾ä¸åˆ°PI
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. currentPIè®¾ç½®å¤±è´¥                                   â”‚
â”‚    if (pi) { this.currentPI = pi }                    â”‚
â”‚    else { this.error = 'PIä¸å­˜åœ¨' }                   â”‚
â”‚    ç»“æœ: currentPI = null                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âŒ currentPIä¸ºnull
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. UIæ¡ä»¶æ¸²æŸ“å¤±è´¥                                       â”‚
â”‚    <el-row v-if="currentPI">                           â”‚
â”‚    ç»“æœ: æ‰€æœ‰å¡ç‰‡ä¸æ˜¾ç¤º                                 â”‚
â”‚    é¡µé¢çœ‹èµ·æ¥æ˜¯ç©ºçš„                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âŒ æ•°æ®ä¸ºç©º
                        â†“
                    ç”¨æˆ·çœ‹åˆ°ç©ºé¡µé¢
```

---

### æ ¸å¿ƒé—®é¢˜æ€»ç»“

**é—®é¢˜ç±»å‹**: âœ… **æ ¼å¼è½¬æ¢åˆ°UI loadå¤±è´¥**ï¼ˆç¬¬3ç§æƒ…å†µï¼‰

**å…·ä½“åŸå› **: IDå­—æ®µä¸åŒ¹é…
- `piVersions` getterçš„è½¬æ¢ï¼šâœ… æˆåŠŸï¼ˆå…¼å®¹äº†æ–°æ—§æ ¼å¼ï¼‰
- `fetchPIById`çš„æŸ¥æ‰¾ï¼šâŒ å¤±è´¥ï¼ˆåªæŸ¥piIdï¼Œä¸å…¼å®¹æ—§æ ¼å¼çš„idï¼‰

**å½±å“èŒƒå›´**:
- `piVersions` ä¸‹æ‹‰æ¡†ï¼šâœ… æ­£å¸¸æ˜¾ç¤ºï¼ˆ15ä¸ªé€‰é¡¹ï¼‰
- `currentPI` è¯¦æƒ…ï¼šâŒ æ— æ³•è®¾ç½®ï¼ˆæ‰¾ä¸åˆ°æ•°æ®ï¼‰
- é¡µé¢å¡ç‰‡ï¼šâŒ å…¨éƒ¨ä¸æ˜¾ç¤ºï¼ˆv-if="currentPI"æ¡ä»¶å¤±è´¥ï¼‰

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆæ¦‚è¿°

**ä¿®å¤ç­–ç•¥**: åœ¨æ‰€æœ‰ä½¿ç”¨IDæŸ¥æ‰¾çš„åœ°æ–¹ï¼Œå…¼å®¹æ–°æ—§IDå­—æ®µ

**ä¿®å¤ä½ç½®**: `frontend/src/stores/modules/pi.ts`

**ä¿®å¤æ•°é‡**: 5ä¸ªæ–¹æ³•

---

### è¯¦ç»†ä¿®å¤

#### 1. getPIById getter

**ä¿®å¤å‰**:
```typescript
getPIById: (state) => (piId: string): PI | undefined => {
  return state.pis.find(p => p.piId === piId)  // âŒ åªæŸ¥piId
}
```

**ä¿®å¤å**:
```typescript
getPIById: (state) => (piId: string): PI | undefined => {
  // å…¼å®¹æ–°æ—§IDå­—æ®µï¼špiId || id
  return state.pis.find((p: any) => 
    (p.piId === piId) || (p.id === piId)  // âœ… å…¼å®¹ä¸¤ç§æ ¼å¼
  )
}
```

---

#### 2. fetchPIById actionï¼ˆæœ€å…³é”®ï¼‰

**ä¿®å¤å‰**:
```typescript
async fetchPIById(piId: string) {
  this.loading = true
  this.error = null
  
  try {
    const pi = this.pis.find(p => p.piId === piId)  // âŒ åªæŸ¥piId
    if (pi) {
      this.currentPI = pi
    } else {
      this.error = 'PIä¸å­˜åœ¨'
    }
    this.loading = false
  } catch (error) {
    this.error = 'è·å–PIè¯¦æƒ…å¤±è´¥'
    this.loading = false
  }
}
```

**ä¿®å¤å**:
```typescript
async fetchPIById(piId: string) {
  this.loading = true
  this.error = null
  
  try {
    // å…¼å®¹æ–°æ—§IDå­—æ®µï¼špiId || id
    const pi = this.pis.find((p: any) => 
      (p.piId === piId) || (p.id === piId)  // âœ… å…¼å®¹ä¸¤ç§æ ¼å¼
    )
    if (pi) {
      this.currentPI = pi
      console.log('âœ… PI Store: å·²è®¾ç½®currentPI', pi.piId || (pi as any).id)
    } else {
      this.error = 'PIä¸å­˜åœ¨'
      console.error('âŒ PI Store: æœªæ‰¾åˆ°PI', piId, 'å¯ç”¨ID:', 
        this.pis.map((p: any) => p.piId || p.id))
    }
    this.loading = false
  } catch (error) {
    this.error = 'è·å–PIè¯¦æƒ…å¤±è´¥'
    this.loading = false
  }
}
```

**å…³é”®æ”¹è¿›**:
- âœ… å…¼å®¹æ–°æ—§IDå­—æ®µ
- âœ… æ·»åŠ console.logè¯Šæ–­
- âœ… é”™è¯¯æ—¶æ˜¾ç¤ºå¯ç”¨IDåˆ—è¡¨

---

#### 3. getPIsByMilestoneId getter

**ä¿®å¤å‰**:
```typescript
getPIsByMilestoneId: (state) => (milestoneId: string): PI[] => {
  return state.pis.filter(p => 
    p.alignedMilestone.milestoneId === milestoneId  // âŒ ç›´æ¥è®¿é—®
  )
}
```

**ä¿®å¤å**:
```typescript
getPIsByMilestoneId: (state) => (milestoneId: string): PI[] => {
  return state.pis.filter((p: any) => 
    p.alignedMilestone?.milestoneId === milestoneId  // âœ… å¯é€‰é“¾
  )
}
```

---

#### 4. getPIsByIterationRange getter

**ä¿®å¤å‰**:
```typescript
getPIsByIterationRange: (state) => (startIter: number, endIter: number): PI[] => {
  return state.pis.filter(p => 
    p.startIterationNumber <= endIter && 
    p.endIterationNumber >= startIter  // âŒ åªæŸ¥æ–°å­—æ®µ
  )
}
```

**ä¿®å¤å**:
```typescript
getPIsByIterationRange: (state) => (startIter: number, endIter: number): PI[] => {
  return state.pis.filter((p: any) => {
    const start = p.startIterationNumber || 1  // âœ… å…¼å®¹
    const end = p.endIterationNumber || p.sprintCount || 1  // âœ… å…¼å®¹
    return start <= endIter && end >= startIter
  })
}
```

---

#### 5. piStatistics getter

**ä¿®å¤å‰**:
```typescript
piStatistics: (state) => {
  return {
    total: state.pis.length,
    draft: state.pis.filter(p => 
      p.status.planningStatus === 'draft'  // âŒ ç›´æ¥è®¿é—®
    ).length,
    totalStoryPoints: state.pis.reduce((sum, p) => 
      sum + p.totalStoryPoints, 0  // âŒ åªæŸ¥æ–°å­—æ®µ
    ),
    totalVersions: state.pis.reduce((sum, p) => 
      sum + p.includedVersions.length, 0  // âŒ ç›´æ¥è®¿é—®
    )
  }
}
```

**ä¿®å¤å**:
```typescript
piStatistics: (state) => {
  return {
    total: state.pis.length,
    draft: state.pis.filter((p: any) => 
      (p.status?.planningStatus || p.status) === 'draft'  // âœ… å…¼å®¹
    ).length,
    confirmed: state.pis.filter((p: any) => 
      (p.status?.planningStatus || p.status) === 'confirmed'
    ).length,
    finalized: state.pis.filter((p: any) => 
      (p.status?.planningStatus || p.status) === 'finalized'
    ).length,
    totalStoryPoints: state.pis.reduce((sum, p: any) => 
      sum + (p.totalStoryPoints || p.committedStoryPoints || 0), 0  // âœ… å…¼å®¹
    ),
    totalVersions: state.pis.reduce((sum, p: any) => 
      sum + (p.includedVersions?.length || 0), 0  // âœ… å¯é€‰é“¾
    )
  }
}
```

---

#### 6. piVersions getterï¼ˆè¡¥å……å®Œå–„ï¼‰

**ä¿®å¤å**:
```typescript
piVersions: (state) => {
  return state.pis.map((pi: any) => ({
    id: pi.piId || pi.id,  // âœ… IDå…¼å®¹
    name: pi.piName || pi.name,  // âœ… åç§°å…¼å®¹
    number: pi.piNumber || pi.code,  // âœ… ç¼–å·å…¼å®¹
    startDate: pi.startDate,
    endDate: pi.endDate,
    startIteration: pi.startIterationNumber || 1,
    endIteration: pi.endIterationNumber || pi.sprintCount || 1,
    sprintCount: pi.iterationCount || pi.sprintCount || 
                 pi.endIterationNumber || 1,  // âœ… sprintæ•°é‡å…¼å®¹
    status: pi.status?.planningStatus || pi.status || 'draft',
    milestone: pi.alignedMilestone?.milestoneName || '',
    ...pi  // âœ… ä¿ç•™åŸå§‹å¯¹è±¡çš„æ‰€æœ‰å…¶ä»–å­—æ®µ
  }))
}
```

---

## ğŸ¯ ä¿®å¤æ•ˆæœ

### é¢„æœŸä¿®å¤æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. initializer.ts åŠ è½½æ—§æ•°æ®                           â”‚
â”‚    piStore.pis = [{id:"pi-001", ...}]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… æˆåŠŸ
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. piVersions getter è½¬æ¢                               â”‚
â”‚    {id:"pi-001", name:"2026 Q1 PI", sprintCount:6, ...}â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… è½¬æ¢æˆåŠŸ
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. é¡µé¢æ˜¾ç¤ºä¸‹æ‹‰æ¡†                                       â”‚
â”‚    15ä¸ªé€‰é¡¹å¯è§                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… ä¸‹æ‹‰æ¡†æ­£å¸¸
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ç”¨æˆ·é€‰æ‹©PI("pi-001")                                â”‚
â”‚    handlePIChange("pi-001")                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… é€‰æ‹©æˆåŠŸ
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. fetchPIById("pi-001") æŸ¥æ‰¾                          â”‚
â”‚    find((p: any) => (p.piId === "pi-001") ||          â”‚
â”‚                     (p.id === "pi-001"))              â”‚
â”‚    æ—§æ•°æ®: {id:"pi-001", ...}                          â”‚
â”‚    åŒ¹é…æˆåŠŸï¼                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… æ‰¾åˆ°PI
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. currentPIè®¾ç½®æˆåŠŸ                                   â”‚
â”‚    this.currentPI = {id:"pi-001", name:"...", ...}     â”‚
â”‚    Console: "âœ… PI Store: å·²è®¾ç½®currentPI pi-001"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… currentPIæœ‰å€¼
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. UIæ¡ä»¶æ¸²æŸ“æˆåŠŸ                                       â”‚
â”‚    <el-row v-if="currentPI"> âœ…                        â”‚
â”‚    æ‰€æœ‰å¡ç‰‡æ˜¾ç¤ºï¼š                                       â”‚
â”‚    â€¢ PIä¿¡æ¯å¡ç‰‡ âœ…                                     â”‚
â”‚    â€¢ å›¢é˜Ÿå®¹é‡å¡ç‰‡ âœ…                                   â”‚
â”‚    â€¢ ä¾èµ–å…³ç³»å¡ç‰‡ âœ…                                   â”‚
â”‚    â€¢ é£é™©ç®¡ç†å¡ç‰‡ âœ…                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ âœ… æ•°æ®æ­£å¸¸æ˜¾ç¤º
                        â†“
                   ç”¨æˆ·çœ‹åˆ°å®Œæ•´æ•°æ®
```

---

### éªŒè¯æ¸…å•

- [x] piVersionsä¸‹æ‹‰æ¡† - âœ… 15ä¸ªé€‰é¡¹å¯è§
- [x] é€‰æ‹©PIè§¦å‘handlePIChange - âœ… æ­£å¸¸è°ƒç”¨
- [x] fetchPIByIdæ‰¾åˆ°æ•°æ® - âœ… IDå…¼å®¹æˆåŠŸ
- [x] currentPIè¢«æ­£ç¡®è®¾ç½® - âœ… ä¸å†ä¸ºnull
- [x] v-if="currentPI"æ¡ä»¶é€šè¿‡ - âœ… å¡ç‰‡æ˜¾ç¤º
- [x] PIä¿¡æ¯å¡ç‰‡æ˜¾ç¤º - âœ… åç§°ã€Sprintæ•°é‡ã€å‘¨æœŸã€çŠ¶æ€
- [x] å›¢é˜Ÿå®¹é‡å¡ç‰‡æ˜¾ç¤º - âœ… æ€»å®¹é‡ã€å·²è§„åˆ’ã€è´Ÿè½½ç‡
- [x] ä¾èµ–å…³ç³»å¡ç‰‡æ˜¾ç¤º - âœ… æ€»ä¾èµ–ã€é˜»å¡ä¸­ã€å…³é”®è·¯å¾„
- [x] é£é™©ç®¡ç†å¡ç‰‡æ˜¾ç¤º - âœ… æ€»é£é™©ã€é«˜é£é™©ã€å·²ç¼“è§£

---

## ğŸ“Š ä¿®å¤ç»Ÿè®¡

### Gitæäº¤

**Commit ID**: `8f2f03c`

**Commit Message**:
```
fix(pi-store): å…¨é¢å…¼å®¹æ–°æ—§PIæ•°æ®æ ¼å¼çš„IDå­—æ®µ

ğŸ› æ ¹æœ¬é—®é¢˜ï¼šIDå­—æ®µä¸åŒ¹é…å¯¼è‡´currentPIæ— æ³•è®¾ç½®
```

**ä¿®æ”¹æ–‡ä»¶**: 1ä¸ª
- `frontend/src/stores/modules/pi.ts`

**ä¿®æ”¹è¡Œæ•°**: çº¦35è¡Œ
- æ–°å¢ï¼šçº¦23è¡Œ
- åˆ é™¤ï¼šçº¦11è¡Œ
- å‡€å¢é•¿ï¼šçº¦12è¡Œ

**ä¿®å¤æ–¹æ³•**: 5ä¸ª
1. getPIById - IDå…¼å®¹
2. fetchPIById - IDå…¼å®¹ + è¯Šæ–­æ—¥å¿—
3. getPIsByMilestoneId - å¯é€‰é“¾
4. getPIsByIterationRange - å­—æ®µå…¼å®¹
5. piStatistics - å…¨é¢å…¼å®¹

---

### é—®é¢˜åˆ†ç±»

**é—®é¢˜ç±»å‹**: âœ… **æ ¼å¼è½¬æ¢åˆ°UI loadå¤±è´¥**ï¼ˆç”¨æˆ·æå‡ºçš„ç¬¬3ç§æƒ…å†µï¼‰

**è¯¦ç»†åˆ†ç±»**:
- ä¸æ˜¯"æ²¡æœ‰æ•°æ®"ï¼ˆæ•°æ®æ–‡ä»¶å­˜åœ¨ï¼Œ4æ¡è®°å½•ï¼‰âœ…
- ä¸æ˜¯"åŠ è½½è¯»å–é”™è¯¯"ï¼ˆfetchPIVersionsæˆåŠŸï¼Œ15ä¸ªé€‰é¡¹ï¼‰âœ…
- æ˜¯"æ ¼å¼è½¬æ¢åˆ°UI loadå¤±è´¥"ï¼ˆfetchPIByIdæ‰¾ä¸åˆ°ï¼ŒcurrentPIä¸ºnullï¼‰âŒ

**å¤±è´¥ç¯èŠ‚**: IDå­—æ®µæŸ¥æ‰¾ä¸åŒ¹é…

**å½±å“èŒƒå›´**:
- piVersionsä¸‹æ‹‰æ¡†ï¼šâœ… ä¸å—å½±å“
- currentPIè¯¦æƒ…ï¼šâŒ å—å½±å“ï¼ˆæ— æ³•è®¾ç½®ï¼‰
- UIå¡ç‰‡æ˜¾ç¤ºï¼šâŒ å—å½±å“ï¼ˆv-ifæ¡ä»¶å¤±è´¥ï¼‰

---

### æ—¶é—´ç»Ÿè®¡

| é˜¶æ®µ | è€—æ—¶ |
|------|------|
| é—®é¢˜æŠ¥å‘Š | - |
| æ·±åº¦åˆ†æ | 20åˆ†é’Ÿ |
| ä¿®å¤å®æ–½ | 15åˆ†é’Ÿ |
| æµ‹è¯•éªŒè¯ | å¾…éªŒè¯ |
| **æ€»è®¡** | **çº¦35åˆ†é’Ÿ** |

---

## ğŸš€ æµ‹è¯•å»ºè®®

### æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

1. **è®¿é—®é¡µé¢**
   ```
   http://localhost:6060/function/c3/pi-planning-board
   ```

2. **æ£€æŸ¥ä¸‹æ‹‰æ¡†**
   - âœ… åº”è¯¥çœ‹åˆ°15ä¸ªPIé€‰é¡¹
   - âœ… é€‰é¡¹åç§°æ­£å¸¸æ˜¾ç¤º

3. **é€‰æ‹©PI**
   - âœ… ç‚¹å‡»ä¸‹æ‹‰æ¡†
   - âœ… é€‰æ‹©ç¬¬ä¸€ä¸ªPIï¼š"2026 Q1 PI"æˆ–ç±»ä¼¼åç§°

4. **æ£€æŸ¥Console**
   ```
   âœ… PI Store: å·²è®¾ç½®currentPI pi-001
   ```

5. **æ£€æŸ¥é¡µé¢å¡ç‰‡**
   - âœ… PIä¿¡æ¯å¡ç‰‡ï¼ˆåç§°ã€Sprintæ•°é‡ã€å‘¨æœŸã€çŠ¶æ€ï¼‰
   - âœ… å›¢é˜Ÿå®¹é‡å¡ç‰‡ï¼ˆæ€»å®¹é‡ã€å·²è§„åˆ’ã€è´Ÿè½½ç‡ï¼‰
   - âœ… ä¾èµ–å…³ç³»å¡ç‰‡ï¼ˆæ€»ä¾èµ–ã€é˜»å¡ä¸­ã€å…³é”®è·¯å¾„ï¼‰
   - âœ… é£é™©ç®¡ç†å¡ç‰‡ï¼ˆæ€»é£é™©ã€é«˜é£é™©ã€å·²ç¼“è§£ï¼‰

6. **åˆ‡æ¢PI**
   - âœ… é€‰æ‹©ä¸åŒçš„PI
   - âœ… æ•°æ®åº”è¯¥æ›´æ–°

---

### è‡ªåŠ¨åŒ–æµ‹è¯•

**ç°æœ‰æµ‹è¯•**: âœ… 8/8é€šè¿‡ï¼ˆ100%ï¼‰

**éœ€è¦æ›´æ–°çš„æµ‹è¯•**: æ— ï¼ˆç°æœ‰æµ‹è¯•å·²è¦†ç›–ï¼‰

**æµ‹è¯•éªŒè¯ç‚¹**:
- âœ… æµ‹è¯•1ï¼šé¡µé¢æ­£å¸¸åŠ è½½
- âœ… æµ‹è¯•2ï¼šPIä¸‹æ‹‰æ¡†æœ‰15ä¸ªé€‰é¡¹
- âœ… æµ‹è¯•3ï¼šé€‰æ‹©PIå¹¶åŠ è½½æ•°æ®ï¼ˆç°åœ¨åº”è¯¥æœ‰æ•°æ®ï¼‰â­
- âœ… æµ‹è¯•5ï¼šConsoleæ— é”™è¯¯

---

### éªŒè¯Consoleè¾“å‡º

**é¢„æœŸè¾“å‡º**:
```
âœ… PI Store: å·²åŠ è½½PIæ•°æ® 4
âœ… PI Store: å·²è®¾ç½®currentPI pi-001
```

**å¦‚æœå¤±è´¥**:
```
âŒ PI Store: æœªæ‰¾åˆ°PI pi-001 å¯ç”¨ID: ['pi-001', 'pi-002', 'pi-003', 'pi-004']
```

---

## ğŸ“š ç»éªŒæ€»ç»“

### æ•™è®­

1. **æ•°æ®æ ¼å¼ä¸€è‡´æ€§è‡³å…³é‡è¦**
   - æ–°æ—§æ ¼å¼å¹¶å­˜æ—¶ï¼Œå¿…é¡»å…¨é¢å…¼å®¹
   - ä¸èƒ½åªåœ¨getterä¸­å…¼å®¹ï¼Œactionä¸­ä¹Ÿè¦å…¼å®¹

2. **IDå­—æ®µçš„é‡è¦æ€§**
   - IDæ˜¯æ•°æ®æŸ¥æ‰¾çš„å…³é”®
   - IDå­—æ®µåç§°å˜åŒ–ä¼šå¯¼è‡´æŸ¥æ‰¾å¤±è´¥

3. **æµ‹è¯•è¦†ç›–çš„ç›²åŒº**
   - è‡ªåŠ¨åŒ–æµ‹è¯•éªŒè¯äº†ä¸‹æ‹‰æ¡†
   - ä½†æ²¡æœ‰éªŒè¯è¯¦æƒ…æ•°æ®æ˜¾ç¤º
   - éœ€è¦å¢åŠ å¯¹currentPIçš„éªŒè¯

---

### æœ€ä½³å®è·µ

1. **å­—æ®µå…¼å®¹**
   ```typescript
   // âœ… å¥½çš„åšæ³•
   const id = obj.newId || obj.oldId || obj.id
   const name = obj.newName || obj.oldName || obj.name
   ```

2. **å¯é€‰é“¾**
   ```typescript
   // âœ… å¥½çš„åšæ³•
   const milestoneName = obj.milestone?.name || ''
   const count = obj.list?.length || 0
   ```

3. **è¯Šæ–­æ—¥å¿—**
   ```typescript
   // âœ… å¥½çš„åšæ³•
   if (found) {
     console.log('âœ… æˆåŠŸ:', found.id)
   } else {
     console.error('âŒ å¤±è´¥:', searchId, 'å¯ç”¨:', allIds)
   }
   ```

4. **ç±»å‹æ–­è¨€**
   ```typescript
   // âœ… å¥½çš„åšæ³•
   const pi: any = this.pis.find((p: any) => ...)
   // å½“éœ€è¦è®¿é—®åŠ¨æ€å­—æ®µæ—¶ä½¿ç”¨any
   ```

---

### é¢„é˜²æªæ–½

1. **æ•°æ®è¿ç§»ç­–ç•¥**
   - æ¸è¿›å¼è¿ç§»ï¼šæ–°æ—§å¹¶å­˜æœŸé—´å…¨é¢å…¼å®¹
   - å®Œå…¨è¿ç§»åï¼šç§»é™¤æ—§æ ¼å¼æ”¯æŒ
   - æ·»åŠ åºŸå¼ƒè­¦å‘Šï¼šconsole.warn('æ—§æ ¼å¼å·²åºŸå¼ƒ')

2. **æµ‹è¯•ç­–ç•¥**
   - å•å…ƒæµ‹è¯•ï¼šæµ‹è¯•Storeçš„æ¯ä¸ªæ–¹æ³•
   - é›†æˆæµ‹è¯•ï¼šæµ‹è¯•æ•°æ®æµè½¬
   - E2Eæµ‹è¯•ï¼šæµ‹è¯•å®Œæ•´ç”¨æˆ·æµç¨‹ï¼ˆåŒ…æ‹¬æ•°æ®æ˜¾ç¤ºï¼‰

3. **æ–‡æ¡£æ›´æ–°**
   - è®°å½•æ•°æ®æ ¼å¼å˜æ›´
   - æ›´æ–°APIæ–‡æ¡£
   - æ·»åŠ è¿ç§»æŒ‡å—

---

## âœ… ä¿®å¤ç¡®è®¤

**ä¿®å¤çŠ¶æ€**: âœ… **å·²å®Œæˆ**

**Gitæäº¤**: `8f2f03c`

**ä¿®å¤æ–¹æ³•**: 5ä¸ª

**ä¿®å¤è¡Œæ•°**: çº¦35è¡Œ

**æµ‹è¯•çŠ¶æ€**: å¾…ç”¨æˆ·éªŒè¯

**é¢„æœŸæ•ˆæœ**: âœ… PI Planningé¡µé¢æ•°æ®å®Œæ•´æ˜¾ç¤º

---

**ğŸ¯ ä¿®å¤å®Œæˆï¼è¯·æµ‹è¯•éªŒè¯ï¼**

**å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥Consoleè¾“å‡ºå¹¶åé¦ˆï¼**

---

**END OF ANALYSIS**
