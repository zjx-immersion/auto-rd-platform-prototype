# 新功能访问指南 - PI Planning 2阶段规划工作台

> 更新时间：2026-01-19

---

## 📍 如何访问新功能

### 方法1：从旧版PI Planning页面进入（推荐）

1. **打开旧版PI Planning页面**
   - 导航至：`固有功能` → `C3: 规划协调` → `PI Planning看板`

2. **选择PI**
   - 在页面顶部选择要规划的PI（例如：2026 Q4 PI）

3. **点击"进入2阶段规划工作台（新版）"按钮**
   - 位于页面右上角，蓝色大按钮，带有箭头图标
   - 点击后会自动跳转到新的规划工作台

### 方法2：直接访问URL

**阶段1页面**（Feature/SSTS排布）：
```
http://localhost:6061/function/c3/planning/pi/pi-001/stage1
```

**阶段2页面**（MR排布）：
```
http://localhost:6061/function/c3/planning/pi/pi-001/stage2
```

> 注意：将 `pi-001` 替换为实际的PI ID

---

## 🆕 新旧版本对比

| 特性 | 旧版PI Planning | 新版2阶段规划工作台 |
|------|----------------|-------------------|
| **规划流程** | 单一页面 | 2个阶段，循序渐进 |
| **Feature/SSTS排布** | 基础功能 | ✅ 拖拽分配到团队×Sprint |
| **MR排布** | 不支持 | ✅ 按Sprint分组，智能默认分配 |
| **依赖管理** | 基础查看 | ✅ 依赖高亮、添加/编辑/删除 |
| **依赖检测** | 简单检查 | ✅ 循环依赖、时间冲突、跨团队依赖 |
| **里程碑设置** | 不支持 | ✅ 关联产品版本和整车节点 |
| **容量检查** | 基础 | ✅ 实时容量计算和超载警告 |
| **冲突报告** | 简单提示 | ✅ 详细冲突报告和解决建议 |
| **依赖可视化** | 不支持 | ✅ ECharts依赖关系图 |

---

## 📖 新功能使用流程

### 阶段1：Feature/SSTS排布工作台

#### 功能说明
- **目标**：将Feature和SSTS分配到不同的Sprint和团队
- **输入**：待分配的Feature和SSTS列表
- **输出**：Feature/SSTS在团队×Sprint矩阵中的分配结果

#### 操作步骤

1. **查看待分配列表（左侧）**
   - 显示所有未分配的Feature和SSTS
   - 支持搜索和类型筛选
   - 点击可查看详情

2. **拖拽分配（右侧看板）**
   - 从左侧列表拖拽Feature/SSTS到右侧看板
   - 看板按"团队×Sprint"矩阵组织
   - 实时显示容量和负载率

3. **设置Sprint里程碑**
   - 点击Sprint按钮设置里程碑
   - 可关联产品版本和整车计划节点
   - 指导规划排期

4. **管理依赖关系**
   - 点击SSTS卡片的依赖图标
   - 添加/编辑/删除依赖关系
   - 设置依赖类型（强/弱/可选）

5. **检测冲突**
   - 点击"检测冲突"按钮
   - 查看详细的冲突报告
   - 根据建议解决冲突

6. **完成阶段1**
   - 点击"完成阶段1"按钮
   - 解锁阶段2

### 阶段2：模块需求排布工作台

#### 功能说明
- **目标**：基于阶段1的结果，将MR分配到Sprint
- **输入**：阶段1的Feature/SSTS分配结果
- **输出**：MR在Sprint中的分配结果

#### 操作步骤

1. **选择团队**
   - 顶部选择要规划的团队
   - 每个团队独立规划

2. **查看阶段1结果（左侧）**
   - 显示该团队在阶段1中分配的Sprint
   - Feature/SSTS分配结果（只读）
   - 显示可用容量

3. **查看MR列表（右侧）**
   - MR按Sprint分组显示
   - 默认显示在所属SSTS的Sprint
   - 支持搜索和筛选

4. **拖拽分配MR**
   - 从右侧列表拖拽MR到左侧Sprint
   - 自动检查容量和依赖
   - 显示负载率

5. **完成阶段2**
   - 点击"完成阶段2"按钮
   - 所有团队完成后，PI Planning完成

---

## 🎨 界面说明

### 阶段1页面布局

```
┌─────────────────────────────────────────────────────────────┐
│ 返回 | PI Planning - 阶段1  [2026 Q1 PI]  保存草稿 完成阶段1 │
├─────────────────────────────────────────────────────────────┤
│ PI信息：Sprint数量、周期、状态、阶段1进度                    │
├──────────────┬──────────────────────────────────────────────┤
│ 待分配列表   │ 团队×Sprint排布看板                          │
│              │                                              │
│ [搜索框]     │ Sprint里程碑设置                             │
│ [类型筛选]   │ ┌────────┬────────┬────────┐               │
│              │ │ 团队    │Sprint1 │Sprint2 │               │
│ Feature (2)  │ ├────────┼────────┼────────┤               │
│ □ FEAT-001   │ │ACC团队 │[卡片]  │[空]    │               │
│ □ FEAT-002   │ ├────────┼────────┼────────┤               │
│              │ │APA团队 │[空]    │[卡片]  │               │
│ SSTS (4)     │ └────────┴────────┴────────┘               │
│ □ SSTS-001   │                                              │
│ □ SSTS-002   │                                              │
│              │                                              │
└──────────────┴──────────────────────────────────────────────┘
```

### 阶段2页面布局

```
┌─────────────────────────────────────────────────────────────┐
│ 返回 | PI Planning - 阶段2  [2026 Q1 PI]  保存草稿 完成阶段2 │
├─────────────────────────────────────────────────────────────┤
│ PI信息：阶段1已完成、阶段2进度                               │
├─────────────────────────────────────────────────────────────┤
│ 团队选择：○ ACC团队  ○ APA团队  ○ LKA团队                   │
├──────────────┬──────────────────────────────────────────────┤
│ Sprint列表   │ MR列表（按Sprint分组）                       │
│              │                                              │
│ Sprint 1     │ [搜索框] [筛选]                              │
│ ┌──────────┐ │                                              │
│ │Feature   │ │ Sprint 2026-01                              │
│ │(只读)    │ │ 所属SSTS: SSTS-001                          │
│ ├──────────┤ │ □ MR-ACC-001 (5 SP)                        │
│ │MR (可拖) │ │ □ MR-ACC-002 (8 SP) 💡默认位置             │
│ │MR-ACC-001│ │                                              │
│ └──────────┘ │ Sprint 2026-02                              │
│              │ □ MR-LKA-001 (6 SP)                        │
│ Sprint 2     │                                              │
│ ┌──────────┐ │                                              │
│ │...       │ │                                              │
└──────────────┴──────────────────────────────────────────────┘
```

---

## ⚠️ 重要提示

### 阶段顺序
- ⚠️ **必须先完成阶段1才能进入阶段2**
- ⚠️ 阶段2依赖于阶段1的分配结果
- ⚠️ 不建议在阶段2开始后修改阶段1的结果

### 数据保存
- ✅ 每个阶段都支持"保存草稿"功能
- ✅ 草稿保存在浏览器localStorage中
- ⚠️ 清除浏览器缓存会丢失草稿
- 🔄 建议定期点击"保存草稿"

### 容量管理
- ⚠️ 超过团队容量会显示警告
- ⚠️ 超载的Sprint会以红色背景显示
- ✅ 系统会阻止严重超载的分配

### 依赖管理
- ⚠️ 依赖项应该在更早或相同的Sprint
- ⚠️ 循环依赖会导致规划失败
- ✅ 使用"检测冲突"功能及时发现问题

---

## 🆘 常见问题

### Q1: 为什么找不到新功能入口？
**A:** 新功能入口在旧版PI Planning页面的右上角，是一个蓝色大按钮，文字为"进入2阶段规划工作台（新版）"。确保：
1. 已经选择了PI
2. 页面完全加载
3. 按钮在页面右上角

### Q2: 可以不用新功能，继续使用旧版吗？
**A:** 可以。新旧版本可以并存使用。但新版功能更强大，建议逐步迁移到新版。

### Q3: 阶段1和阶段2可以分开做吗？
**A:** 可以。完成阶段1后，可以随时返回继续阶段2。每个阶段都有独立的草稿保存。

### Q4: 多人可以同时规划吗？
**A:** 当前版本不支持实时多人协作。建议：
- 阶段1：由PM统一规划
- 阶段2：各团队负责人分别规划自己团队的部分

### Q5: 如何导出规划结果？
**A:** 在依赖冲突检测对话框中有"导出报告"按钮。完整的规划导出功能正在开发中。

---

## 📚 相关文档

- **设计文档**：`page-design/C3-规划协调/02-PI-Planning/C3-F18-PI-Planning-2阶段规划工作台.md`
- **实施报告**：`PI-PLANNING-2-STAGE-IMPLEMENTATION-REPORT.md`
- **任务清单**：`PI-PLANNING-FUTURE-TASKS.md`
- **进度报告**：`IMPLEMENTATION-PROGRESS-REPORT.md`

---

## 🐛 问题反馈

如果遇到问题或有建议，请联系开发团队或在项目管理系统中提交Issue。

---

**文档版本**：1.0  
**最后更新**：2026-01-19  
**维护人员**：开发团队
