# C0-F05: 版本规划

> **功能编号**: C0-F05  
> **功能名称**: 版本规划  
> **主要用户**: PM（项目经理）、PO（产品负责人）  
> **页面类型**: 列表+表单页  
> **优先级**: P0  
> **价值流阶段**: S4-项目立项

---

## 一、功能概述

### 1.1 功能描述
为整车项目规划版本，将Epic分配到不同版本，制定版本发布计划，支撑项目的版本管理和发布节奏。

### 1.2 业务价值
- 建立清晰的版本发布计划
- 将需求（Epic）映射到版本
- 支撑敏捷规模化的版本管理
- 连接需求管理（C1）和迭代执行（C3）

### 1.3 使用场景
- PM制定项目版本发布计划
- PO将Epic分配到目标版本
- 团队查看版本范围和计划

---

## 二、页面布局

### 2.1 版本列表页

```
┌─────────────────────────────────────────────────────────────────┐
│ 面包屑: 首页 > 项目管理 > PRJ-2025-001 > 版本规划               │
├─────────────────────────────────────────────────────────────────┤
│ 页面标题: 版本规划                        [+ 创建版本] [导出]   │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 项目信息                                                     │ │
│ │ 项目: 岚图H56智能驾驶平台项目 | 项目代号: H56               │ │
│ │ 项目周期: 2025-02-01 ~ 2026-01-31 | PI数量: 4个             │ │
│ └─────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 筛选: [全部状态▼] [全部类型▼]              [搜索版本...]   │ │
│ └─────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 版本列表 (4个)                                               │ │
│ │ ┌───────────────────────────────────────────────────────────┐│ │
│ │ │ 版本卡片 1                                                ││ │
│ │ │ ┌─────────────────────────────────────────────────────────┐││ │
│ │ │ │ V1.0 - MVP版本                    状态: 🟢 规划中      │││ │
│ │ │ │ 版本类型: 主版本 | 发布日期: 2025-06-30                │││ │
│ │ │ │ Epic数量: 2个 | Feature数量: 8个                       │││ │
│ │ │ │ 进度: ████████░░░░░░░░░░ 40%                          │││ │
│ │ │ │ 负责人: 👤 张伟 (PO)                                   │││ │
│ │ │ │ [查看详情] [编辑] [Epic分配] [更多▼]                  │││ │
│ │ │ └─────────────────────────────────────────────────────────┘││ │
│ │ │                                                           ││ │
│ │ │ 版本卡片 2                                                ││ │
│ │ │ ┌─────────────────────────────────────────────────────────┐││ │
│ │ │ │ V2.0 - 完整功能版本              状态: 🟡 待规划       │││ │
│ │ │ │ 版本类型: 主版本 | 发布日期: 2025-12-31                │││ │
│ │ │ │ Epic数量: 3个 | Feature数量: 12个                      │││ │
│ │ │ │ 进度: ░░░░░░░░░░░░░░░░░░░░ 0%                         │││ │
│ │ │ │ 负责人: 👤 张伟 (PO)                                   │││ │
│ │ │ │ [查看详情] [编辑] [Epic分配] [更多▼]                  │││ │
│ │ │ └─────────────────────────────────────────────────────────┘││ │
│ │ └───────────────────────────────────────────────────────────┘│ │
│ └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 2.2 创建版本页

```
┌─────────────────────────────────────────────────────────────┐
│ 面包屑: 首页 > 项目管理 > PRJ-2025-001 > 版本规划 > 创建版本│
├─────────────────────────────────────────────────────────────┤
│ 页面标题: 创建版本                    [保存草稿] [创建]     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ 基本信息                                                    │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 版本号 *                                                │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ V1.0                                                │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ │                                                         │ │
│ │ 版本名称 *                                              │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ MVP版本                                             │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ │                                                         │ │
│ │ 版本类型 *                                              │ │
│ │ ⚫ 主版本  ⚪ 次版本  ⚪ 补丁版本                        │ │
│ │                                                         │ │
│ │ 版本描述 *                                              │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ 最小可行产品版本，实现核心L2+自动驾驶功能           │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 发布计划                                                    │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 计划发布日期 *                                          │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ 2025-06-30 📅                                       │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ │                                                         │ │
│ │ 版本负责人 *                                            │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ 👤 张伟 (PO)                                        │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ Epic分配 * (已选择 2个)                                     │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [搜索Epic...]                              [+ 添加Epic] │ │
│ │ ┌─────────────────────────────────────────────────────┐ │ │
│ │ │ ☑ ADAS-E001 | L2+级自动驾驶功能 | P0 | 8个Feature  │ │ │
│ │ │ ☑ CABIN-E001 | 智能座舱交互系统 | P0 | 5个Feature  │ │ │
│ │ └─────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 版本目标                                                    │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 1. 实现高速公路L2+自动驾驶功能                          │ │
│ │ 2. 完成智能座舱核心交互功能                             │ │
│ │ 3. 通过功能安全认证                                     │ │
│ │ [+ 添加目标]                                            │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│ [取消]                                  [保存草稿] [创建]   │
└─────────────────────────────────────────────────────────────┘
```

---

## 三、表单字段设计

### 3.1 基本信息

| 字段名称 | 字段类型 | 是否必填 | 默认值 | 验证规则 | 说明 |
|---------|---------|---------|--------|---------|------|
| 版本号 | 文本框 | 是 | - | 格式：V{主版本}.{次版本}.{补丁} | 如：V1.0、V1.1、V1.0.1 |
| 版本名称 | 文本框 | 是 | - | 长度≤50字符 | 版本名称 |
| 版本类型 | 单选按钮 | 是 | 主版本 | - | 主版本/次版本/补丁版本 |
| 版本描述 | 文本域 | 是 | - | 长度≤500字符 | 版本描述 |

### 3.2 发布计划

| 字段名称 | 字段类型 | 是否必填 | 默认值 | 验证规则 | 说明 |
|---------|---------|---------|--------|---------|------|
| 计划发布日期 | 日期选择器 | 是 | - | ≥今天 | 计划发布日期 |
| 版本负责人 | 用户选择器 | 是 | - | - | 版本负责人 |
| 版本状态 | 下拉选择 | 是 | 规划中 | - | 规划中/开发中/测试中/已发布 |

### 3.3 Epic分配

| 字段名称 | 字段类型 | 是否必填 | 默认值 | 验证规则 | 说明 |
|---------|---------|---------|--------|---------|------|
| Epic列表 | Epic选择器 | 是 | - | 至少选1个 | 分配到该版本的Epic |

### 3.4 版本目标

| 字段名称 | 字段类型 | 是否必填 | 默认值 | 验证规则 | 说明 |
|---------|---------|---------|--------|---------|------|
| 版本目标 | 列表编辑器 | 是 | - | 至少1条 | 版本目标列表 |

---

## 四、页面交互

### 4.1 版本列表交互

**筛选功能**:
- 按状态筛选：全部/规划中/开发中/测试中/已发布
- 按类型筛选：全部/主版本/次版本/补丁版本
- 搜索：支持版本号、版本名称搜索

**版本卡片操作**:
- 查看详情：跳转到版本详情页
- 编辑：跳转到版本编辑页
- Epic分配：打开Epic分配对话框
- 更多：删除版本、复制版本、导出版本

**排序**:
- 默认按发布日期倒序排列
- 支持按版本号、状态、进度排序

### 4.2 创建版本交互

**表单验证**:
- 版本号：检查格式，不能与已有版本重复
- 发布日期：必须在项目周期内
- Epic分配：至少选择1个Epic

**Epic选择**:
- 只显示未分配或已分配到当前版本的Epic
- 显示Epic的优先级、Feature数量
- 支持搜索和批量选择

**智能提示**:
- 根据版本类型自动建议版本号
- 根据Epic工作量估算发布日期
- 显示版本范围统计（Epic数、Feature数）

### 4.3 按钮交互

**[创建]按钮**:
- 验证所有必填字段
- 提交成功后提示："版本创建成功"
- 跳转到版本详情页

**[保存草稿]按钮**:
- 保存当前填写内容为草稿状态
- 提示："草稿已保存"
- 保持在当前页面

**[取消]按钮**:
- 点击后弹窗确认："确定要取消吗？未保存的内容将丢失。"
- 确认后返回版本列表页

---

## 五、API接口

### 5.1 获取版本列表

**接口**: `GET /api/projects/{projectId}/versions`

**请求参数**:
```
status: string (可选) - 版本状态
type: string (可选) - 版本类型
keyword: string (可选) - 搜索关键词
```

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 4,
    "items": [
      {
        "versionId": "V-001",
        "versionNumber": "V1.0",
        "versionName": "MVP版本",
        "versionType": "MAJOR",
        "status": "PLANNING",
        "releaseDate": "2025-06-30",
        "owner": {
          "userId": "U002",
          "userName": "张伟"
        },
        "epicCount": 2,
        "featureCount": 8,
        "progress": 40,
        "description": "最小可行产品版本，实现核心L2+自动驾驶功能"
      }
    ]
  }
}
```

### 5.2 创建版本

**接口**: `POST /api/projects/{projectId}/versions`

**请求示例**:
```json
{
  "versionNumber": "V1.0",
  "versionName": "MVP版本",
  "versionType": "MAJOR",
  "description": "最小可行产品版本，实现核心L2+自动驾驶功能",
  "releaseDate": "2025-06-30",
  "owner": "U002",
  "status": "PLANNING",
  "epicIds": ["ADAS-E001", "CABIN-E001"],
  "objectives": [
    "实现高速公路L2+自动驾驶功能",
    "完成智能座舱核心交互功能",
    "通过功能安全认证"
  ]
}
```

**响应示例**:
```json
{
  "code": 200,
  "message": "版本创建成功",
  "data": {
    "versionId": "V-001",
    "versionNumber": "V1.0",
    "versionName": "MVP版本",
    "status": "PLANNING",
    "createdAt": "2025-01-15T10:00:00Z"
  }
}
```

### 5.3 Epic分配

**接口**: `PUT /api/versions/{versionId}/epics`

**请求示例**:
```json
{
  "epicIds": ["ADAS-E001", "CABIN-E001", "ADAS-E002"]
}
```

**响应示例**:
```json
{
  "code": 200,
  "message": "Epic分配成功",
  "data": {
    "versionId": "V-001",
    "epicCount": 3,
    "featureCount": 15
  }
}
```

### 5.4 获取可分配Epic列表

**接口**: `GET /api/projects/{projectId}/epics/assignable?versionId={versionId}`

**响应示例**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 5,
    "items": [
      {
        "epicId": "ADAS-E001",
        "epicName": "L2+级自动驾驶功能",
        "priority": "P0",
        "featureCount": 8,
        "estimatedWorkload": 120,
        "currentVersion": null,
        "isAssigned": false
      },
      {
        "epicId": "ADAS-E002",
        "epicName": "智能泊车系统",
        "priority": "P1",
        "featureCount": 5,
        "estimatedWorkload": 80,
        "currentVersion": "V1.0",
        "isAssigned": true
      }
    ]
  }
}
```

---

## 六、版本详情页

### 6.1 页面布局

```
┌─────────────────────────────────────────────────────────────────┐
│ 面包屑: 首页 > 项目管理 > PRJ-2025-001 > 版本规划 > V1.0        │
├─────────────────────────────────────────────────────────────────┤
│ 版本详情: V1.0 - MVP版本      [编辑] [Epic分配] [发布] [更多▼] │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 基本信息                                                     │ │
│ │ 版本号: V1.0                     状态: 🟢 规划中            │ │
│ │ 版本名称: MVP版本                                            │ │
│ │ 版本类型: 主版本                 发布日期: 2025-06-30        │ │
│ │ 负责人: 👤 张伟 (PO)            进度: 40%                   │ │
│ │ 创建时间: 2025-01-15             更新时间: 2025-01-15        │ │
│ │                                                             │ │
│ │ 版本描述:                                                    │ │
│ │ 最小可行产品版本，实现核心L2+自动驾驶功能                    │ │
│ └─────────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ 标签页: [Epic列表] [Feature列表] [版本目标] [发布检查]     │ │
│ │ ┌─────────────────────────────────────────────────────────┐ │ │
│ │ │ Epic列表 (2个)                                           │ │ │
│ │ │ ┌───────────────────────────────────────────────────────┐│ │ │
│ │ │ │ ID | Epic名称 | 优先级 | Feature数 | 进度 | 操作     ││ │ │
│ │ │ ├───────────────────────────────────────────────────────┤│ │ │
│ │ │ │ ADAS-E001 | L2+级自动驾驶功能 | P0 | 8 | 50% | [详情]││ │ │
│ │ │ │ CABIN-E001 | 智能座舱交互系统 | P0 | 5 | 30% | [详情]││ │ │
│ │ │ └───────────────────────────────────────────────────────┘│ │ │
│ │ │                                                         │ │ │
│ │ │ 统计信息:                                                │ │ │
│ │ │ Epic总数: 2个 | Feature总数: 13个 | SSTS总数: 45个      │ │ │
│ │ │ 预估工作量: 200人天 | 已完成: 80人天 | 剩余: 120人天     │ │ │
│ │ └─────────────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 6.2 版本目标标签页

```
┌─────────────────────────────────────────────────────────────┐
│ 版本目标 (3个)                                [+ 添加目标]   │
├─────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ ☑ 1. 实现高速公路L2+自动驾驶功能                        │ │
│ │    状态: 进行中 | 完成度: 60% | 负责人: 张伟            │ │
│ │                                                         │ │
│ │ ☐ 2. 完成智能座舱核心交互功能                           │ │
│ │    状态: 进行中 | 完成度: 40% | 负责人: 李明            │ │
│ │                                                         │ │
│ │ ☐ 3. 通过功能安全认证                                   │ │
│ │    状态: 未开始 | 完成度: 0% | 负责人: 刘芳             │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

---

## 七、页面跳转

### 7.1 入口
- 项目详情页 > 版本规划标签页
- 顶部导航 > 项目管理 > 选择项目 > 版本规划
- Epic详情页 > 目标版本链接

### 7.2 出口
- 创建版本 → 版本详情页
- 查看详情 → 版本详情页
- 编辑版本 → 版本编辑页
- Epic分配 → Epic分配对话框
- Epic详情 → Epic详情页（C1-F03）

---

## 八、Mock数据

### 8.1 版本列表数据

```json
[
  {
    "versionId": "V-001",
    "versionNumber": "V1.0",
    "versionName": "MVP版本",
    "versionType": "MAJOR",
    "status": "PLANNING",
    "releaseDate": "2025-06-30",
    "owner": {
      "userId": "U002",
      "userName": "张伟",
      "role": "PO"
    },
    "epicCount": 2,
    "featureCount": 13,
    "sstsCount": 45,
    "progress": 40,
    "estimatedWorkload": 200,
    "completedWorkload": 80,
    "description": "最小可行产品版本，实现核心L2+自动驾驶功能",
    "objectives": [
      "实现高速公路L2+自动驾驶功能",
      "完成智能座舱核心交互功能",
      "通过功能安全认证"
    ],
    "createdAt": "2025-01-15T10:00:00Z",
    "updatedAt": "2025-01-15T10:00:00Z"
  },
  {
    "versionId": "V-002",
    "versionNumber": "V2.0",
    "versionName": "完整功能版本",
    "versionType": "MAJOR",
    "status": "PLANNING",
    "releaseDate": "2025-12-31",
    "owner": {
      "userId": "U002",
      "userName": "张伟",
      "role": "PO"
    },
    "epicCount": 3,
    "featureCount": 20,
    "sstsCount": 68,
    "progress": 0,
    "estimatedWorkload": 350,
    "completedWorkload": 0,
    "description": "完整功能版本，实现所有L2+自动驾驶和智能座舱功能",
    "objectives": [
      "实现城市道路L2+自动驾驶功能",
      "完成智能泊车系统",
      "实现完整的智能座舱体验"
    ],
    "createdAt": "2025-01-15T10:00:00Z",
    "updatedAt": "2025-01-15T10:00:00Z"
  }
]
```

### 8.2 版本类型

```json
[
  {
    "value": "MAJOR",
    "label": "主版本",
    "description": "重大功能更新"
  },
  {
    "value": "MINOR",
    "label": "次版本",
    "description": "功能增强和改进"
  },
  {
    "value": "PATCH",
    "label": "补丁版本",
    "description": "Bug修复和小改进"
  }
]
```

### 8.3 版本状态

```json
[
  {
    "value": "PLANNING",
    "label": "规划中",
    "color": "blue"
  },
  {
    "value": "DEVELOPING",
    "label": "开发中",
    "color": "green"
  },
  {
    "value": "TESTING",
    "label": "测试中",
    "color": "orange"
  },
  {
    "value": "RELEASED",
    "label": "已发布",
    "color": "gray"
  }
]
```

---

## 九、特殊说明

### 9.1 版本号规则
- 主版本：V{主版本}.0，如：V1.0、V2.0
- 次版本：V{主版本}.{次版本}，如：V1.1、V1.2
- 补丁版本：V{主版本}.{次版本}.{补丁}，如：V1.0.1、V1.1.1

### 9.2 Epic分配规则
- 一个Epic只能分配到一个版本
- 分配Epic时自动关联其下的所有Feature
- 取消分配时需确认是否影响已开始的开发工作

### 9.3 版本进度计算
- 版本进度 = (已完成Feature数 / 总Feature数) × 100%
- 自动汇总所有Epic的进度
- 实时更新版本进度

### 9.4 版本依赖
- 支持版本间的依赖关系
- 前置版本未发布时，后续版本不能发布
- 显示版本依赖关系图

---

## 十、与其他功能的关系

### 10.1 与C1-需求管理的关系
- **Epic池** → **版本规划**: Epic分配到版本
- **Feature** → **版本**: 通过Epic关联到版本
- **版本** → **Epic详情**: 在Epic详情中显示目标版本

### 10.2 与C3-迭代执行的关系
- **版本规划** → **PI规划**: 版本范围指导PI规划
- **版本** → **Sprint**: Sprint交付物汇总到版本

### 10.3 与C0-F06版本发布的关系
- **版本规划** → **版本发布**: 规划完成后进入发布流程
- **版本状态**: 从规划中 → 开发中 → 测试中 → 已发布

---

**设计完成日期**: 2025-01-15
**设计人员**: Auto-RD平台设计组
**下一步**: 查看 [C0-F06-版本发布.md](./C0-F06-版本发布.md)

