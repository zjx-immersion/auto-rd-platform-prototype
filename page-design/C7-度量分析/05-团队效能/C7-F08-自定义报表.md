# C7-F08: 自定义报表

> **功能编号**: C7-F08  
> **功能名称**: 自定义报表  
> **所属模块**: C7-度量分析 > 团队效能  
> **主要用户**: DL/PO  
> **页面类型**: 配置页 + 报表页

---

## 一、功能概述

### 1.1 功能定位
自定义报表支持用户灵活配置度量指标和报表，满足个性化的度量分析需求。

### 1.2 核心价值
- **灵活配置**: 自定义度量指标和维度
- **多样化展示**: 支持多种图表类型
- **定时生成**: 支持定时生成和发送
- **数据导出**: 支持多种格式导出

---

## 二、页面设计

### 2.1 报表列表

```
┌─────────────────────────────────────────────────────────────┐
│ 📊 自定义报表                        [新建报表] [刷新]      │
├─────────────────────────────────────────────────────────────┤
│  我的报表 (8)                                               │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 📈 周度研发效能报告                                    │ │
│  │ 更新时间: 2025-02-15 09:00 | 创建人: DL-张三          │ │
│  │ 包含指标: 需求交付周期、代码提交频率、缺陷密度        │ │
│  │ [查看] [编辑] [复制] [删除]                            │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 📊 月度质量分析报告                                    │ │
│  │ 更新时间: 2025-02-01 09:00 | 创建人: QA-王五          │ │
│  │ 包含指标: 缺陷密度、测试覆盖率、缺陷修复周期          │ │
│  │ [查看] [编辑] [复制] [删除]                            │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 📉 团队效能对比分析                                    │ │
│  │ 更新时间: 2025-02-10 09:00 | 创建人: DL-张三          │ │
│  │ 包含指标: 团队产能、协作效率、资源利用率              │ │
│  │ [查看] [编辑] [复制] [删除]                            │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  共享报表 (5)                                               │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 📊 DORA指标看板                                        │ │
│  │ 更新时间: 2025-02-15 09:00 | 创建人: 系统管理员       │ │
│  │ 包含指标: 部署频率、变更前置时间、变更失败率          │ │
│  │ [查看] [复制]                                          │ │
│  └────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 报表配置

```
┌─────────────────────────────────────────────────────────────┐
│ 📊 新建报表                          [保存] [预览] [取消]  │
├─────────────────────────────────────────────────────────────┤
│  基本信息                                                   │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 报表名称: [周度研发效能报告                    ]      │ │
│  │ 报表描述: [每周研发效能分析，包含需求、开发、质量指标]│ │
│  │ 报表类型: ● 个人报表  ○ 共享报表                     │ │
│  │ 更新频率: [每周一 ▼] [09:00 ▼]                       │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  数据源配置                                                 │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 时间范围: [最近7天 ▼]                                 │ │
│  │ 项目范围: [智能驾驶系统 ▼] [传感器融合 ▼]            │ │
│  │ 团队范围: [智能驾驶团队 ▼]                            │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  指标配置                                                   │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 已选指标 (6)                                           │ │
│  │                                                        │ │
│  │ 需求度量:                                              │ │
│  │ ☑ 需求交付周期                                        │ │
│  │ ☑ 需求变更率                                          │ │
│  │                                                        │ │
│  │ 开发效能:                                              │ │
│  │ ☑ 代码提交频率                                        │ │
│  │ ☑ MR审查时长                                          │ │
│  │                                                        │ │
│  │ 质量度量:                                              │ │
│  │ ☑ 缺陷密度                                            │ │
│  │ ☑ 测试覆盖率                                          │ │
│  │                                                        │ │
│  │ [添加指标]                                             │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  图表配置                                                   │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 图表1: 需求交付周期趋势                               │ │
│  │ • 图表类型: [折线图 ▼]                                │ │
│  │ • 指标: 需求交付周期                                  │ │
│  │ • 维度: 时间(周)                                      │ │
│  │ [编辑] [删除] [上移] [下移]                           │ │
│  │                                                        │ │
│  │ 图表2: 开发效能对比                                   │ │
│  │ • 图表类型: [柱状图 ▼]                                │ │
│  │ • 指标: 代码提交频率、MR审查时长                      │ │
│  │ • 维度: 时间(周)                                      │ │
│  │ [编辑] [删除] [上移] [下移]                           │ │
│  │                                                        │ │
│  │ [添加图表]                                             │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  发送配置                                                   │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ ☑ 自动发送报表                                        │ │
│  │ 发送方式: ☑ 邮件  ☑ 企业微信  ☐ 钉钉                │ │
│  │ 收件人: [DL-张三, PO-李四, QA-王五          ]         │ │
│  │ 发送时间: [每周一 ▼] [09:00 ▼]                       │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  导出配置                                                   │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 支持格式: ☑ PDF  ☑ Excel  ☑ PNG                      │ │
│  └────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 2.3 报表预览

```
┌─────────────────────────────────────────────────────────────┐
│ 📊 周度研发效能报告                  [导出] [分享] [编辑]  │
├─────────────────────────────────────────────────────────────┤
│  报告周期: 2025-02-09 ~ 2025-02-15                         │
│  生成时间: 2025-02-15 09:00                                │
│                                                             │
│  核心指标概览                                               │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐      │
│  │需求交付  │ │代码提交  │ │MR审查    │ │缺陷密度  │      │
│  │周期      │ │频率      │ │时长      │ │          │      │
│  │ 12.5天   │ │ 8.5次/天 │ │  4.2小时 │ │ 2.5/KLOC │      │
│  │ ↓ -2天   │ │ ↑ +1.2   │ │ ↓ -0.5h  │ │ ↓ -0.3   │      │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘      │
│                                                             │
│  需求交付周期趋势                                           │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 天数                                                   │ │
│  │ 20│                                                    │ │
│  │ 15│  ●───●───●───●───●───●                            │ │
│  │ 10│                                                    │ │
│  │   └────────────────────────────────────────────       │ │
│  │   W1  W2  W3  W4  W5  W6                             │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  开发效能对比                                               │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 次数/小时                                              │ │
│  │ 10│                                                    │ │
│  │  5│  ███  ███  ███  ███  ███  ███  代码提交           │ │
│  │   │  ███  ███  ███  ███  ███  ███  MR审查             │ │
│  │   └────────────────────────────────────────────       │ │
│  │   W1  W2  W3  W4  W5  W6                             │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  质量指标分析                                               │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ 缺陷密度: 2.5/KLOC ↓ -0.3                             │ │
│  │ 测试覆盖率: 78% ↑ +3%                                 │ │
│  │ 缺陷修复周期: 3.2天 ↓ -0.5天                          │ │
│  └────────────────────────────────────────────────────────┘ │
│                                                             │
│  总结与建议                                                 │
│  ┌───────────────────────────────────────────────────────┐ │
│  │ ✅ 亮点:                                              │ │
│  │ • 需求交付周期缩短2天，效率提升                       │ │
│  │ • 代码提交频率提升，开发活跃度高                      │ │
│  │ • 缺陷密度下降，质量有所提升                          │ │
│  │                                                        │ │
│  │ ⚠️ 关注点:                                            │ │
│  │ • MR审查时长仍需优化                                  │ │
│  │ • 测试覆盖率距离目标还有差距                          │ │
│  │                                                        │ │
│  │ 💡 建议:                                              │ │
│  │ • 加强代码审查流程，缩短审查时长                      │ │
│  │ • 提升自动化测试覆盖率                                │ │
│  └────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

---

## 三、数据设计

```typescript
interface CustomReport {
  id: string;
  name: string;
  description: string;
  type: 'PERSONAL' | 'SHARED';
  owner: string;
  updateFrequency: {
    type: 'DAILY' | 'WEEKLY' | 'MONTHLY' | 'MANUAL';
    dayOfWeek?: number;
    time?: string;
  };
  dataSource: {
    timeRange: string;
    projects: string[];
    teams: string[];
  };
  metrics: Array<{
    category: string;
    name: string;
    enabled: boolean;
  }>;
  charts: Array<{
    id: string;
    title: string;
    type: 'LINE' | 'BAR' | 'PIE' | 'RADAR' | 'TABLE';
    metrics: string[];
    dimension: string;
    order: number;
  }>;
  sendConfig: {
    enabled: boolean;
    methods: Array<'EMAIL' | 'WECHAT' | 'DINGTALK'>;
    recipients: string[];
    schedule: { dayOfWeek: number; time: string };
  };
  exportFormats: Array<'PDF' | 'EXCEL' | 'PNG'>;
  createdAt: Date;
  updatedAt: Date;
}
```

---

## 四、Mock数据

```json
{
  "id": "RPT-001",
  "name": "周度研发效能报告",
  "description": "每周研发效能分析，包含需求、开发、质量指标",
  "type": "PERSONAL",
  "owner": "DL-张三",
  "updateFrequency": {
    "type": "WEEKLY",
    "dayOfWeek": 1,
    "time": "09:00"
  },
  "dataSource": {
    "timeRange": "最近7天",
    "projects": ["智能驾驶系统", "传感器融合"],
    "teams": ["智能驾驶团队"]
  },
  "metrics": [
    {"category": "需求度量", "name": "需求交付周期", "enabled": true},
    {"category": "开发效能", "name": "代码提交频率", "enabled": true}
  ],
  "charts": [
    {
      "id": "CHART-001",
      "title": "需求交付周期趋势",
      "type": "LINE",
      "metrics": ["需求交付周期"],
      "dimension": "时间(周)",
      "order": 1
    }
  ],
  "sendConfig": {
    "enabled": true,
    "methods": ["EMAIL", "WECHAT"],
    "recipients": ["DL-张三", "PO-李四", "QA-王五"],
    "schedule": {"dayOfWeek": 1, "time": "09:00"}
  },
  "exportFormats": ["PDF", "EXCEL", "PNG"],
  "createdAt": "2025-01-16T00:00:00Z",
  "updatedAt": "2025-02-15T09:00:00Z"
}
```

---

**设计完成日期**: 2025-01-16

