# C3-F11: 依赖跟踪

> **功能编号**: C3-F11  
> **功能名称**: 依赖跟踪  
> **所属模块**: C3-规划协调  
> **优先级**: P1  
> **设计日期**: 2026-01-17

---

## 一、功能概述

### 1.1 功能定位
依赖跟踪负责持续监控已识别依赖的状态，确保依赖按时解决，及时发现和处理依赖风险。

### 1.2 核心价值
- ✅ 实时跟踪依赖状态
- ✅ 依赖进度可视化
- ✅ 延期预警和升级
- ✅ 协调记录和沟通
- ✅ 依赖关闭管理

### 1.3 用户角色
- **主要用户**: TPM
- **协作用户**: PM, DL, 外部对接人
- **查看用户**: 全体团队

---

## 二、页面设计

### 2.1 依赖跟踪主页面
```
┌─────────────────────────────────────────────────────────────────┐
│ Auto-RD平台 > PI 2024.4 > 依赖跟踪             [导出] [批量更新]│
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ ┌─ 筛选和统计 ──────────────────────────────────────────┐      │
│ │ 状态: [全部 ▾]  严重程度: [全部 ▾]  负责人: [全部 ▾]  │      │
│ │ 类型: [全部 ▾]  风险: [全部 ▾]  [搜索...]             │      │
│ │                                                        │      │
│ │ 统计: 总计15个依赖                                     │      │
│ │ • 🟢 已解决: 8个  🟡 进行中: 5个  🔴 阻塞: 2个       │      │
│ │ • ⚠️ 3个依赖延期风险  ⏰ 2个依赖本周到期              │      │
│ └────────────────────────────────────────────────────┘      │
│                                                                 │
│ ┌─ 依赖列表 ────────────────────────────────────────────┐      │
│ │                                                        │      │
│ │ 🔴 D-001: 地图数据API v2.0接口  [阻塞] [更新状态]    │      │
│ │ ├────────────────────────────────────────────────┤   │      │
│ │ │ 类型: 外部依赖  严重程度: 高  风险: 高          │   │      │
│ │ │ 依赖方: 地图供应商  负责人: 李四(TPM)           │   │      │
│ │ │ 计划日期: 2024-10-30  当前状态: 延期2周        │   │      │
│ │ │ 影响: F-004车载地图优化 (43SP)                  │   │      │
│ │ │                                                    │   │      │
│ │ │ 进度时间线:                                        │   │      │
│ │ │ ●─────●─────●─────⊗─────○  (75% → 延期)       │   │      │
│ │ │ 识别  协调  进行  阻塞  计划完成                │   │      │
│ │ │ 9/15  9/20  9/25  10/18  10/30                  │   │      │
│ │ │                                                    │   │      │
│ │ │ 最新更新 (2024-10-18):                            │   │      │
│ │ │ "API测试发现性能问题,需要重构,预计延期2周"      │   │      │
│ │ │ 更新人: 李四                                       │   │      │
│ │ │                                                    │   │      │
│ │ │ 缓解措施:                                          │   │      │
│ │ │ • 已升级到供应商技术总监级别                    │   │      │
│ │ │ • 建立每日沟通机制                              │   │      │
│ │ │ • 制定Plan B: 使用v1.9接口+性能优化            │   │      │
│ │ │                                                    │   │      │
│ │ │ [查看详情] [记录沟通] [升级] [调整计划]        │   │      │
│ │ └────────────────────────────────────────────────┘   │      │
│ │                                                        │      │
│ │ 🟡 D-005: AI算法模型v3.0  [进行中] [更新状态]        │      │
│ │ ├────────────────────────────────────────────────┤   │      │
│ │ │ 类型: 内部依赖  严重程度: 中  风险: 低          │   │      │
│ │ │ 依赖方: 算法团队  负责人: 王五                  │   │      │
│ │ │ 计划日期: 2024-11-05  进度: 80%  ✓ 按时        │   │      │
│ │ │                                                    │   │      │
│ │ │ 进度: ●─────●─────●─────●─────○  (80%)         │   │      │
│ │ │ [查看详情] [沟通记录]                           │   │      │
│ │ └────────────────────────────────────────────────┘   │      │
│ │                                                        │      │
│ │ 🟢 D-012: 传感器固件升级  [已解决] [归档]            │      │
│ │ ├────────────────────────────────────────────────┤   │      │
│ │ │ 完成日期: 2024-10-15  提前3天完成               │   │      │
│ │ │ [查看详情]                                        │   │      │
│ │ └────────────────────────────────────────────────┘   │      │
│ │                                                        │      │
│ └────────────────────────────────────────────────────┘      │
│                                                                 │
│ ┌─ 本周到期依赖 ────────────────────────────────────────┐      │
│ │ ⏰ 2个依赖需在本周完成:                                │      │
│ │ • D-008: 数据库升级 (10/20)  🟡 进行中              │      │
│ │ • D-010: 接口联调 (10/22)  🟡 进行中                │      │
│ └────────────────────────────────────────────────────┘      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 三、数据模型

```typescript
interface DependencyTracking {
  dependencyId: string;
  
  // 状态跟踪
  status: 'identified' | 'coordinating' | 'in_progress' | 
          'blocked' | 'resolved' | 'closed';
  progress: number;  // 0-100
  
  // 时间跟踪
  plannedDate: Date;
  actualDate?: Date;
  estimatedDate?: Date;
  delay?: number;  // 天数
  
  // 负责人
  tracker: string;  // 跟踪人(通常是TPM)
  coordinator: string;  // 协调人
  externalContact?: string;  // 外部联系人
  
  // 更新记录
  updates: {
    date: Date;
    updater: string;
    status: string;
    progress: number;
    notes: string;
    attachments?: string[];
  }[];
  
  // 沟通记录
  communications: {
    date: Date;
    type: 'meeting' | 'email' | 'call' | 'chat';
    participants: string[];
    summary: string;
    actionItems: string[];
  }[];
  
  // 缓解措施
  mitigations: {
    action: string;
    owner: string;
    status: 'planned' | 'in_progress' | 'completed';
    effectivenessScore?: number;
  }[];
  
  // 升级记录
  escalations: {
    date: Date;
    level: 'team' | 'manager' | 'director' | 'vp';
    reason: string;
    outcome: string;
  }[];
  
  // 预警
  alerts: {
    type: 'delay' | 'blocking' | 'risk_increased';
    severity: 'low' | 'medium' | 'high' | 'critical';
    message: string;
    triggeredAt: Date;
  }[];
}
```

---

## 四、API接口

```typescript
// 获取依赖跟踪列表
GET /api/pi/{piId}/dependency-tracking

// 更新依赖状态
PUT /api/dependencies/{depId}/tracking
Request: {
  status: string;
  progress: number;
  notes: string;
  estimatedDate?: Date;
}

// 记录沟通
POST /api/dependencies/{depId}/communications
Request: Communication

// 添加缓解措施
POST /api/dependencies/{depId}/mitigations
Request: Mitigation

// 升级依赖
POST /api/dependencies/{depId}/escalate
Request: {
  level: string;
  reason: string;
}

// 关闭依赖
POST /api/dependencies/{depId}/close
Request: {
  actualDate: Date;
  summary: string;
}
```

---

## 五、业务规则

### 5.1 依赖状态流转

```
identified (已识别)
  ↓
coordinating (协调中)
  ↓
in_progress (进行中)
  ↓ (正常)          ↓ (异常)
resolved (已解决)   blocked (阻塞)
  ↓                  ↓ (解决后)
closed (已关闭)      in_progress
```

### 5.2 预警规则

**延期预警**:
```
if 当前日期 > 计划日期 - 7天 && 进度 < 70%:
  触发"可能延期"预警(中等)

if 当前日期 > 计划日期 && status != 'resolved':
  触发"已延期"预警(高)
```

**阻塞预警**:
```
if status == 'blocked' && 阻塞时间 > 3天:
  触发"长期阻塞"预警(高)
```

**风险升级预警**:
```
if 依赖方多次延期 || 沟通响应慢:
  触发"需要升级"预警(中等)
```

### 5.3 升级策略

**升级触发条件**:
1. 依赖延期 > 1周
2. 阻塞 > 3天
3. 依赖方不响应
4. 影响关键Feature

**升级层级**:
```
Team级 → Manager级 → Director级 → VP级
(1周)    (2周)        (3周)         (严重影响)
```

---

## 六、交互设计

### 6.1 进度时间线可视化

```
●─────●─────●─────●─────○
识别  协调  进行  解决  关闭

颜色编码:
● 已完成 (绿色)
● 当前阶段 (蓝色)
⊗ 阻塞 (红色)
○ 未开始 (灰色)
```

### 6.2 批量更新

- 选择多个依赖批量更新状态
- 批量记录本周沟通
- 批量发送提醒通知

### 6.3 自动提醒

**提醒时机**:
- 依赖到期前3天
- 依赖延期当天
- 依赖1周无更新
- 需要升级时

**提醒方式**:
- 系统通知
- 邮件提醒
- 仪表板高亮

---

## 七、测试要点

- [x] 依赖状态更新
- [x] 进度记录和计算
- [x] 沟通记录添加
- [x] 缓解措施跟踪
- [x] 预警触发规则
- [x] 升级流程
- [x] 批量操作
- [x] 自动提醒

---

**设计完成日期**: 2026-01-17  
**设计状态**: ✅ 已完成
