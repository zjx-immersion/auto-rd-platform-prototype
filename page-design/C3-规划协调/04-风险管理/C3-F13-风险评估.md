# C3-F13: 风险评估

> **功能编号**: C3-F13  
> **功能名称**: 风险评估  
> **所属模块**: C3-规划协调  
> **优先级**: P1  
> **设计日期**: 2026-01-17

---

## 一、功能概述

### 1.1 功能定位
风险评估对已识别的风险进行概率和影响评估，计算风险等级，确定优先级。

### 1.2 核心价值
- ✅ 标准化风险评估方法
- ✅ 量化风险等级
- ✅ 风险矩阵可视化
- ✅ 风险优先级排序
- ✅ 评估历史记录

---

## 二、页面设计

### 2.1 风险评估页面
```
┌──────────────────────────────────────────────────────────────┐
│ 风险评估 > R-T01: 新技术栈不成熟              [保存] [取消] │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│ ┌─ 风险基本信息 ────────────────────────────────────────┐  │
│ │ ID: R-T01                                                │  │
│ │ 标题: 新技术栈不成熟                                     │  │
│ │ 类型: 技术风险  识别日期: 2024-09-20                    │  │
│ │ 识别人: 王五  当前状态: 待评估                          │  │
│ └────────────────────────────────────────────────────┘  │
│                                                              │
│ ┌─ 概率评估 ────────────────────────────────────────────┐  │
│ │ 发生概率: ⚫○○○○ 选择: [中等(60%) ▾]                   │  │
│ │                                                          │  │
│ │ 评分说明:                                                │  │
│ │ • 很低(10%): 几乎不可能发生                            │  │
│ │ • 低(30%): 不太可能发生                                │  │
│ │ • 中(60%): 可能发生                                     │  │
│ │ • 高(80%): 很可能发生                                   │  │
│ │ • 很高(95%): 几乎确定发生                              │  │
│ │                                                          │  │
│ │ 历史数据参考:                                            │  │
│ │ 类似项目中此类风险发生率: 55% (5/9次)                  │  │
│ │                                                          │  │
│ │ 判断依据:                                                │  │
│ │ ┌────────────────────────────────────────────────┐    │  │
│ │ │ React 19仍在beta阶段，社区反馈存在一些Bug。根据    │    │  │
│ │ │ 历史经验，使用beta版本技术栈出现问题概率约60%。    │    │  │
│ │ └────────────────────────────────────────────────┘    │  │
│ └────────────────────────────────────────────────────┘  │
│                                                              │
│ ┌─ 影响评估 ────────────────────────────────────────────┐  │
│ │ 影响程度: ⚫⚫⚫○○ 选择: [高 ▾]                          │  │
│ │                                                          │  │
│ │ 影响维度:                                                │  │
│ │ ┌────────────────────────────────────────────────┐    │  │
│ │ │ 进度影响:  ⚫⚫⚫○○ (3/5)                            │    │  │
│ │ │ 可能导致2-4周延期                                   │    │  │
│ │ │                                                      │    │  │
│ │ │ 成本影响:  ⚫⚫○○○ (2/5)                            │    │  │
│ │ │ 需要额外投入开发和测试资源                         │    │  │
│ │ │                                                      │    │  │
│ │ │ 质量影响:  ⚫⚫⚫⚫○ (4/5)                            │    │  │
│ │ │ 可能导致系统稳定性问题，影响用户体验               │    │  │
│ │ │                                                      │    │  │
│ │ │ 范围影响:  ⚫⚫○○○ (2/5)                            │    │  │
│ │ │ 可能需要降低部分功能复杂度                         │    │  │
│ │ │                                                      │    │  │
│ │ │ 综合影响: (3+2+4+2)/4 = 2.75 → 高                  │    │  │
│ │ └────────────────────────────────────────────────┘    │  │
│ │                                                          │  │
│ │ 影响范围:                                                │  │
│ │ • Feature: F-002, F-004 (2个，共98 SP)                 │  │
│ │ • PI目标: 目标1(用户体验提升)                          │  │
│ │ • 团队: 智驾团队、座舱团队                             │  │
│ └────────────────────────────────────────────────────┘  │
│                                                              │
│ ┌─ 风险等级计算 ────────────────────────────────────────┐  │
│ │                影响程度 →                                │  │
│ │       │  很低   低     中     高    很高                │  │
│ │  ─────┼──────────────────────────────────             │  │
│ │  很高 │ 低    中    高    高    极高                     │  │
│ │  概  高│ 低    低    中    高    高                      │  │
│ │  率  中│ 很低  低    中 [🔴] 高                         │  │
│ │  ↓  低│ 很低  很低  低    中    中                      │  │
│ │    很低│ 很低  很低  很低  低    低                      │  │
│ │                                                          │  │
│ │ 风险等级: 🔴 高 (High)                                   │  │
│ │ 风险值(P×I): 60% × 3 = 1.8                              │  │
│ │ 优先级: P1 (需要重点关注和缓解)                         │  │
│ └────────────────────────────────────────────────────┘  │
│                                                              │
│ ┌─ 评估信息 ────────────────────────────────────────────┐  │
│ │ 评估方法: [定量分析 ▾]                                   │  │
│ │ 评估人: [张三(PM) ▾]                                     │  │
│ │ 评估日期: [2024-09-22]                                   │  │
│ │ 评审人: [李四(TPM) ▾]                                    │  │
│ │                                                          │  │
│ │ 备注:                                                    │  │
│ │ ┌────────────────────────────────────────────────┐    │  │
│ │ │ 建议立即制定缓解措施，考虑降级到React 18稳定版    │    │  │
│ │ │ 或投入更多测试资源。                                │    │  │
│ │ └────────────────────────────────────────────────┘    │  │
│ └────────────────────────────────────────────────────┘  │
│                                                              │
│ ┌─ 评估历史 ────────────────────────────────────────────┐  │
│ │ 2024-09-22  概率:中(60%)  影响:高  等级:高  by 张三    │  │
│ │ 2024-10-05  概率:高(80%)  影响:高  等级:极高  by 李四  │  │
│ │ → 风险升级，已实施缓解措施后重新评估                   │  │
│ └────────────────────────────────────────────────────┘  │
│                                                              │
│                                      [保存评估] [进入缓解]  │
└──────────────────────────────────────────────────────────────┘
```

---

## 三、数据模型

```typescript
interface RiskAssessment {
  id: string;
  riskId: string;
  
  // 概率评估
  probability: {
    level: 'very_low' | 'low' | 'medium' | 'high' | 'very_high';
    percentage: number;  // 10, 30, 60, 80, 95
    rationale: string;
    historicalData?: {
      similarCases: number;
      occurrences: number;
      rate: number;
    };
  };
  
  // 影响评估
  impact: {
    overall: 'very_low' | 'low' | 'medium' | 'high' | 'very_high';
    dimensions: {
      schedule: number;  // 1-5
      cost: number;
      quality: number;
      scope: number;
    };
    averageScore: number;
    affectedFeatures: string[];
    affectedObjectives: string[];
    affectedTeams: string[];
  };
  
  // 风险等级
  severity: {
    level: 'very_low' | 'low' | 'medium' | 'high' | 'critical';
    riskScore: number;  // P × I
    priority: 'P0' | 'P1' | 'P2';
    needsImmediateAction: boolean;
  };
  
  // 评估信息
  assessmentMethod: 'qualitative' | 'quantitative' | 'expert' | 'monte_carlo';
  assessor: string;
  reviewer: string;
  assessmentDate: Date;
  notes: string;
  
  // 历史
  previousAssessments: {
    date: Date;
    probability: number;
    impact: number;
    severity: string;
    assessor: string;
  }[];
  
  // 状态
  status: 'assessed' | 'approved' | 'outdated';
  validUntil: Date;
}
```

---

## 四、API接口

```typescript
// 创建/更新评估
POST /api/risks/{riskId}/assessment
PUT /api/assessments/{assessmentId}
Request: RiskAssessment

// 获取评估详情
GET /api/risks/{riskId}/assessment

// 获取历史评估
GET /api/risks/{riskId}/assessment/history

// 风险矩阵数据
GET /api/pi/{piId}/risks/matrix

// 批量评估
POST /api/pi/{piId}/risks/batch-assess
Request: {riskId: string, assessment: RiskAssessment}[]

// Monte Carlo模拟
POST /api/risks/{riskId}/monte-carlo
Request: {
  scenarios: number;
  probabilityRange: [min, max];
  impactRange: [min, max];
}
```

---

## 五、业务规则

### 5.1 概率和影响等级定义

**概率等级**:
```
很低 (10%): 几乎不可能发生
低  (30%): 不太可能发生
中  (60%): 可能发生
高  (80%): 很可能发生
很高 (95%): 几乎确定发生
```

**影响等级**:
```
很低 (1): 可忽略的影响
低  (2): 轻微影响，可通过常规手段应对
中  (3): 中等影响，需要额外资源
高  (4): 重大影响，可能导致目标无法达成
很高 (5): 灾难性影响，项目失败
```

### 5.2 风险矩阵

```
        影响 →
概率   很低  低   中   高  很高
↓  ┌───┬───┬───┬───┬───┐
很高│ 低│ 中│ 高│ 高│极高│
   ├───┼───┼───┼───┼───┤
高 │ 低│ 低│ 中│ 高│ 高│
   ├───┼───┼───┼───┼───┤
中 │很低│ 低│ 中│ 高│ 高│
   ├───┼───┼───┼───┼───┤
低 │很低│很低│ 低│ 中│ 中│
   ├───┼───┼───┼───┼───┤
很低│很低│很低│很低│ 低│ 低│
   └───┴───┴───┴───┴───┘

风险值 = 概率(%) × 影响值
```

### 5.3 优先级判定

```
极高风险(P×I >3.0): P0，立即处理
高风险(2.0<P×I<=3.0): P1，优先处理
中风险(1.0<P×I<=2.0): P2，计划处理
低/很低风险(P×I<=1.0): P3，监控即可
```

### 5.4 重新评估触发条件

- 风险缓解措施实施后
- PI每个Sprint结束
- 风险实际发生
- 项目环境重大变化
- 距上次评估超过4周

---

## 六、交互设计

### 6.1 滑块评分

- 拖动滑块选择概率/影响等级
- 实时显示风险矩阵位置
- 实时计算风险等级

### 6.2 批量评估

- 批量选择待评估风险
- 统一设置评估参数
- 支持差异化调整

### 6.3 Monte Carlo模拟

- 输入概率和影响范围
- 运行多次模拟
- 生成概率分布图
- 计算置信区间

---

## 七、测试要点

- [x] 概率和影响评估
- [x] 风险等级计算
- [x] 风险矩阵展示
- [x] 优先级排序
- [x] 评估历史记录
- [x] 批量评估
- [x] Monte Carlo模拟

---

**设计完成日期**: 2026-01-17  
**设计状态**: ✅ 已完成
