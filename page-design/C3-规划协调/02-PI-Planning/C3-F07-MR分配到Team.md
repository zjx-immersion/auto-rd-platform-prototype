# C3-F07: MR分配到Team

> **功能编号**: C3-F07  
> **功能名称**: MR分配到Team  
> **所属模块**: C3-规划协调 > PI Planning  
> **优先级**: P0（核心功能）

## 功能概述

MR(Module Requirement)分配到Team是PI Planning的关键环节，将Feature下的MR分配给具体的敏捷团队。系统支持基于团队技能、容量、依赖关系的智能推荐，并提供拖拽式的可视化分配界面。

### 业务价值
- 明确交付责任：每个MR有明确的负责团队
- 技能匹配：根据团队技能和MR需求进行匹配
- 容量控制：实时监控团队容量，避免过载
- 依赖管理：识别跨团队依赖，提前协调

## 页面布局

```
┌──────────────────────────────────────────────────────────┐
│  MR分配 - Feature: 移动端用户体验优化                     │
├──────────────────────────────────────────────────────────┤
│  [←返回] [智能分配] [保存草稿] [提交分配]                 │
├──────────────────────────────────────────────────────────┤
│                                                            │
│  分配总览                                                  │
│  ┌────────────────────────────────────────────────────┐  │
│  │ 总MR数: 12  │ 已分配: 8  │ 未分配: 4  │ 进度: 67% │  │
│  └────────────────────────────────────────────────────┘  │
│                                                            │
│  左侧: 待分配MR列表                                        │
│  ┌────────────────────────────────────────────────────┐  │
│  │ [搜索MR...] [筛选▾]                                 │  │
│  │                                                     │  │
│  │ 未分配(4个)                                         │  │
│  │ ┌─────────────────────────────────────────────┐   │  │
│  │ │ [MR-001] 登录页面重构              [拖动]   │   │  │
│  │ │ 工作量: 40 SP │ 优先级: 高                  │   │  │
│  │ │ 技能: iOS, Swift │ 依赖: MR-003            │   │  │
│  │ │ 💡 推荐: Team A (技能匹配度95%)            │   │  │
│  │ └─────────────────────────────────────────────┘   │  │
│  │                                                     │  │
│  │ │ [MR-005] 支付流程优化              [拖动]   │   │  │
│  │ │ [MR-008] 性能监控                  [拖动]   │   │  │
│  │ │ [MR-012] 数据埋点                  [拖动]   │   │  │
│  └────────────────────────────────────────────────────┘  │
│                                                            │
│  右侧: 团队容量视图                                        │
│  ┌────────────────────────────────────────────────────┐  │
│  │ Team A - 移动端团队                          82%   │  │
│  │ ─────────────────────────────────────────────────  │  │
│  │ 容量: 220 SP │ 已分配: 180 SP │ 可用: 40 SP       │  │
│  │ 技能: iOS, Android, Swift, Kotlin                 │  │
│  │                                                     │  │
│  │ 已分配MR(3个):                                      │  │
│  │   [MR-002] 首页改版 (50 SP) [×]                   │  │
│  │   [MR-004] 搜索优化 (45 SP) [×]                   │  │
│  │   [MR-006] UI组件 (40 SP) [×]                     │  │
│  │   [MR-010] 动画效果 (45 SP) [×]                   │  │
│  │                                                     │  │
│  │ [+ 放置MR到此处]                                   │  │
│  └────────────────────────────────────────────────────┘  │
│                                                            │
│  │ Team B - 后端服务团队                        97%   │  │
│  │ ─────────────────────────────────────────────────  │  │
│  │ 容量: 180 SP │ 已分配: 175 SP │ 可用: 5 SP        │  │
│  │ ⚠️  警告: 容量接近满载                             │  │
│  │ 已分配MR(4个): ...                                 │  │
│  └────────────────────────────────────────────────────┘  │
│                                                            │
│  │ Team C - 测试团队                           55%   │  │
│  │ 可用: 90 SP │ 可承接MR                            │  │
│  └────────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────┘
```

## 数据字段

```typescript
interface MRAllocation {
  mrId: string;
  mrName: string;
  storyPoints: number;
  priority: string;
  skills: string[];
  dependencies: string[];
  teamId?: string;
  teamName?: string;
  status: 'unassigned' | 'assigned' | 'in_progress' | 'done';
  recommendations: TeamRecommendation[];
}

interface TeamRecommendation {
  teamId: string;
  teamName: string;
  matchScore: number;        // 匹配度(0-100)
  skillMatch: number;        // 技能匹配度
  capacityScore: number;     // 容量分数
  workloadScore: number;     // 负载分数
  reason: string;
}
```

## API接口

```typescript
// 获取分配数据
GET /api/feature/{featureId}/mr-allocation

// 分配MR到Team
POST /api/mr/{mrId}/assign
Request: { teamId: "TEAM-A" }

// 智能分配
POST /api/feature/{featureId}/smart-assign
Response: { assignments: [...] }
```

## 交互设计

1. **拖拽分配**: 从左侧拖动MR到右侧团队卡片
2. **智能推荐**: 为每个MR推荐最匹配的团队
3. **容量预警**: 分配后实时更新团队利用率，超过85%警告
4. **依赖检查**: 分配时检查依赖关系，提示跨团队依赖

**设计完成日期**: 2026-01-17
